!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).SVGRealRenderer=t()}(this,(function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function o(e,t,o){return e(o={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&o.path)}},o.exports),o.exports}var s=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=void 0;var o=function(){function e(e){var t=this;this.eventHandlers={},e.forEach((function(e){t.eventHandlers[e]=new Map}))}return e.prototype.on=function(e,t,o){this.eventHandlers[e].has(t)||this.eventHandlers[e].set(t,o)},e.prototype.off=function(e,t){this.eventHandlers[e].delete(t)},e.prototype.emit=function(e,t){this.eventHandlers[e].forEach((function(e){e(t)}))},e}();t.EventEmitter=o})),n=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RealRendererEventList=void 0,t.RealRendererEventList=["start-render","stop-render","change-scale","change-offsets","import"]})),r=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getRGBColorString=void 0,t.getRGBColorString=function(e){return"rgb("+255*e[0]+", "+255*e[1]+", "+255*e[2]+")"}})),i=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Node=void 0;var o=function(){function e(e,t,o){var s=document.createElementNS("http://www.w3.org/2000/svg",this.elementName);this.elementName=t,this.strokeNodeType=o,this.node=s,this.section=e}return e.prototype.export=function(){return{type:this.strokeNodeType,data:this.node.outerHTML.toString(),section:this.section}},e.prototype.import=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.innerHTML=e,this.node=t.firstChild,t.removeChild(this.node),t.remove()},e.prototype.setStroke=function(e){this.node.setAttribute("stroke",e)},e.prototype.setFill=function(e){this.node.setAttribute("fill",e)},e.prototype.setStrokeWidth=function(e){this.node.setAttribute("stroke-width",e.toString())},e.prototype.setDashed=function(e){this.node.setAttribute("stroke-dasharray","2,2"),this.setStroke(e)},e.prototype.setId=function(e){this.node.setAttribute("id",e)},e.prototype.setClassName=function(e){this.node.classList.add(e)},e.prototype.delete=function(){this.node.remove()},e}();t.Node=o})),a=o((function(t,o){var s,n=e&&e.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.Path=void 0;var r=function(e){function t(t,o){var s=e.call(this,o,"path","path")||this,n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",t),s.node=n,s.section=o,s}return n(t,e),t.prototype.updatePath=function(e){this.node.setAttribute("d",e)},t.prototype.appendPath=function(e){this.node.setAttribute("d",this.node.getAttribute("d")+" "+e)},t}(i.Node);o.Path=r})),h=o((function(t,o){var s,n=e&&e.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.Polygon=void 0;var r=function(e){function t(t,o){var s=e.call(this,o,"polygon","polygon")||this,n=document.createElementNS("http://www.w3.org/2000/svg","polygon"),r="";return t.forEach((function(e){r+=e[0]+","+e[1]+" "})),n.setAttribute("points",r),s.node=n,s.section=o,s}return n(t,e),t.prototype.updatePoints=function(e){var t="";e.forEach((function(e){t+=e[0]+","+e[1]+" "})),this.node.setAttribute("points",t)},t.prototype.addPoint=function(e){this.node.setAttribute("points",this.node.getAttribute("points")+(e[0]+",")+e[1]+" ")},t}(i.Node);o.Polygon=r})),u=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getBlankGraphPaths=void 0,t.getBlankGraphPaths=function(e,t,o){var s=e[0],n=e[1],i=new a.Path("","bg");switch(o.type){case"none":break;case"axes":var u=Math.floor(n*(o.xOffset/100)),d=Math.floor(s*(o.yOffset/100));i.setStroke(r.getRGBColorString(o.axesColor)),i.appendPath("M 0,"+d+" H "+(e[0]-1)),i.appendPath("M "+u+",0 V "+(e[1]-1));break;case"grid":var l=e[0]*(o.xSpacing/100),c=e[1]*(o.ySpacing/100);i.setStroke(r.getRGBColorString(o.lineColor));for(var p=l;p<e[0];p+=l)i.appendPath("M "+p+",0 V "+(e[1]-1));for(var f=c;f<e[1];f+=c)i.appendPath("M 0,"+f+" H "+(e[0]-1));break;case"ruled":var g="horizontal"===o.orientation?e[1]:e[0],_=g*(o.spacing/100);i.setStroke(r.getRGBColorString(o.lineColor));for(var v=_;v<g;v+=_){var S=void 0;S="horizontal"===o.orientation?"M 0,"+v+" H "+(e[0]-1):"M "+v+",0 V "+(e[1]-1),i.appendPath(S)}}var m=new h.Polygon([[0,0],[0,e[1]],[e[0],e[1]],[e[0],0]],"bg");return m.setFill(r.getRGBColorString(t)),m.setStroke(r.getRGBColorString(t)),[m,i]}})),d=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})})),l=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RealRendererDefaults=void 0,t.RealRendererDefaults={bgColor:[0,0,0],bgType:{type:"axes",axesColor:[1,1,1],xOffset:20,yOffset:20},drawsPerFrame:1,timeStep:1/60,initTime:0,scaleFactor:1}})),c=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=void 0,t.clamp=function(e,t,o){return Math.min(Math.max(e,t),o)}})),p=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.redo=t.undo=void 0,t.undo=function(e){void 0===e&&(e=1),this._strokeIndex=c.clamp(this._strokeIndex-e,0,this.strokes.length-1);for(var t=this._strokeIndex+1;t<this.strokes.length;t++)this.strokes[t].forEach((function(e){return e.delete()}));return this},t.redo=function(e){void 0===e&&(e=1);for(var t=c.clamp(e,e,this.strokes.length-this._strokeIndex-1),o=0;o<t;o++)this._strokeIndex++,this._display(this.strokes[this._strokeIndex]);return this}})),f=o((function(t,o){var s,n=e&&e.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.Circle=void 0;var r=function(e){function t(t,o,s){var n=e.call(this,s,"circle","circle")||this,r=document.createElementNS("http://www.w3.org/2000/svg","circle");return r.setAttribute("cx",t[0].toString()),r.setAttribute("cy",t[1].toString()),r.setAttribute("r",o.toString()),n.node=r,n.section=s,n}return n(t,e),t.prototype.updateRadius=function(e){this.node.setAttribute("r",e.toString())},t.prototype.updateCenter=function(e){this.node.setAttribute("cx",e[0].toString()),this.node.setAttribute("cy",e[1].toString())},t}(i.Node);o.Circle=r})),g=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.removeLine=t.newLine=void 0,t.newLine=function(){this.tspans[this.cursorIndex+1]&&(this._setTspanPositioning(this.cursorSpan,"lineBreak"),this._addTspan("",this.cursorIndex+1,"spanBefore"),this.cursorIndex++,this.lineIndexes.push(this.cursorIndex),this.lineIndexes.sort((function(e,t){return e-t})))},t.removeLine=function(){var e=this.lineIndexes.splice(this.lineIndexes.indexOf(this.cursorIndex),1)[0];this.tspans[e].remove(),this.tspans.splice(e,1),this.lineIndexes=this.lineIndexes.map((function(t){return t>=e?t-1:t})),this.cursorIndex=e-1}})),_=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.addCursor=t.destroyCursor=t.moveCursorUp=t.moveCursorDown=t.moveCursorRight=t.moveCursorLeft=void 0;var o=function(e){var t=e[0],o=e[1];return[t+o[0],o.slice(1)]},s=function(e){var t=e[0],o=e[1];return[t.slice(0,-1),t[t.length-1]+o]},n=function(e,t){var o=e[0],s=e[1],n=t([o.textContent,s.textContent]),r=n[0],i=n[1];o.textContent=r,s.textContent=i};t.moveCursorLeft=function(){this.tspans[this.cursorIndex].textContent.length>0?(n([this.tspans[this.cursorIndex],this.tspans[this.cursorIndex+1]],s),""===this.tspans[this.cursorIndex].textContent&&0!==this.cursorIndex&&this._setTspanPositioning(this.cursorSpan,"lineBreak")):this.cursorIndex>0&&(this._setTspanPositioning(this.tspans[this.cursorIndex+1],"lineBreak"),this.cursorIndex=this.lineIndexes[this.lineIndexes.indexOf(this.cursorIndex)-1],this._setTspanPositioning(this.tspans[this.cursorIndex+1],"inline"),this.cursorSpan.remove(),this.tspans[this.cursorIndex].insertAdjacentElement("afterend",this.cursorSpan),this._setTspanPositioning(this.cursorSpan,"inline"),this.lineIndexes[this.lineIndexes.indexOf(this.cursorIndex+1)]=this.cursorIndex+2)},t.moveCursorRight=function(){this.tspans[this.cursorIndex+1]&&this.tspans[this.cursorIndex+1].textContent.length>0?(n([this.tspans[this.cursorIndex],this.tspans[this.cursorIndex+1]],o),""!==this.tspans[this.cursorIndex].textContent&&0!==this.cursorIndex&&(this._setTspanPositioning(this.cursorSpan,"inline"),this._setTspanPositioning(this.tspans[this.cursorIndex],"lineBreak"))):this.cursorIndex<this.tspans.length-2&&(this.cursorIndex=this.lineIndexes[this.lineIndexes.indexOf(this.cursorIndex)+1]-1,this.cursorSpan.remove(),this.tspans[this.cursorIndex].insertAdjacentElement("afterend",this.cursorSpan),this._setTspanPositioning(this.cursorSpan,"lineBreak"),this._setTspanPositioning(this.tspans[this.cursorIndex+1],"inline"),this.lineIndexes[this.lineIndexes.indexOf(this.cursorIndex+1)]=this.cursorIndex)},t.moveCursorDown=function(){var e=this.lineIndexes[this.lineIndexes.indexOf(this.cursorIndex)+1];if(e){var t=this.tspans[this.cursorIndex].textContent,o=this.tspans[this.cursorIndex+1].textContent;this.tspans[this.cursorIndex].textContent=t+o;var s=this.tspans[e].textContent,n=s.length,r=Math.min(t.length-1,n-1),i=[s.slice(0,r+1),s.slice(r+1)];this.tspans[e-1].textContent=i[0],this.tspans[e].textContent=i[1],this.cursorSpan.remove(),this.tspans[e-1].insertAdjacentElement("afterend",this.cursorSpan),this._setTspanPositioning(this.tspans[e],"inline"),""===i[0]?this._setTspanPositioning(this.cursorSpan,"lineBreak"):this._setTspanPositioning(this.tspans[e-1],"lineBreak"),this.lineIndexes[this.lineIndexes.indexOf(e)]=e-1,this.lineIndexes.sort((function(e,t){return e-t})),this.cursorIndex=e-1}},t.moveCursorUp=function(){var e=this.lineIndexes[this.lineIndexes.indexOf(this.cursorIndex)-1];if(this.lineIndexes.includes(e)){var t=this.tspans[this.cursorIndex].textContent,o=this.tspans[this.cursorIndex+1].textContent;this.tspans[this.cursorIndex+1].textContent=t+o;var s=this.tspans[e].textContent,n=s.length,r=Math.min(t.length-1,n-1),i=[s.slice(0,r+1),s.slice(r+1)];this.tspans[e].textContent=i[0],this.tspans[e+1].textContent=i[1],this.cursorSpan.remove(),this.tspans[e].insertAdjacentElement("afterend",this.cursorSpan),this._setTspanPositioning(this.tspans[e+1],"inline"),this._setTspanPositioning(this.tspans[this.cursorIndex+1],"lineBreak"),this.lineIndexes[this.lineIndexes.indexOf(this.cursorIndex)]=this.cursorIndex+1,this.lineIndexes.sort((function(e,t){return e-t})),this.cursorIndex=e}},t.destroyCursor=function(){this.cursorSpan.remove()},t.addCursor=function(){this.tspans[this.cursorIndex].insertAdjacentElement("afterend",this.cursorSpan)}})),v=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.deleteLastCharacter=t.appendText=t.getText=t._updateText=t._getCurrentSpanText=void 0,t._getCurrentSpanText=function(){return this.tspans[this.cursorIndex].textContent},t._updateText=function(e){this.tspans[this.cursorIndex].textContent=e,""!==this.tspans[this.cursorIndex].textContent&&0!==this.cursorIndex&&(this._setTspanPositioning(this.cursorSpan,"inline"),this._setTspanPositioning(this.tspans[this.cursorIndex],"lineBreak"))},t.getText=function(){return this.tspans.map((function(e){return e.textContent})).join("")},t.appendText=function(e){this._updateText(this._getCurrentSpanText()+e)},t.deleteLastCharacter=function(){this._updateText(this._getCurrentSpanText().slice(0,-1)),""===this._getCurrentSpanText()&&this.cursorIndex>0&&this.removeLine()}})),S=o((function(t,o){var s,n=e&&e.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=e&&e.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var s=Array(e),n=0;for(t=0;t<o;t++)for(var r=arguments[t],i=0,a=r.length;i<a;i++,n++)s[n]=r[i];return s};Object.defineProperty(o,"__esModule",{value:!0}),o.Text=void 0;var a=function(e){function t(t,o,s){var n=e.call(this,s,"text","text")||this;n.tspans=[],n.cursorIndex=0,n.lineIndexes=[],n.position=[0,0],n.newLine=g.newLine,n.removeLine=g.removeLine,n.addCursor=_.addCursor,n.destroyCursor=_.destroyCursor,n.moveCursorLeft=_.moveCursorLeft,n.moveCursorRight=_.moveCursorRight,n.moveCursorDown=_.moveCursorDown,n.moveCursorUp=_.moveCursorUp,n._getCurrentSpanText=v._getCurrentSpanText,n._updateText=v._updateText,n.getText=v.getText,n.appendText=v.appendText,n.deleteLastCharacter=v.deleteLastCharacter;var i=document.createElementNS("http://www.w3.org/2000/svg","text");return n.node=i,n.section=s,n.node.setAttribute("text-anchor","middle"),n._addTspan(o),n.cursorSpan=document.createElementNS("http://www.w3.org/2000/svg","tspan"),n.node.appendChild(n.cursorSpan),n.cursorSpan.classList.add("svg-real-db-text-cursor"),n.cursorSpan.style.setProperty("position","relative"),n.cursorSpan.textContent="|",n.cursorIndex=0,n._addTspan("",n.cursorIndex+1),n.lineIndexes.push(0),n.position=r(t),n.node.setAttribute("x",n.position[0].toString()),n.node.setAttribute("y",n.position[1].toString()),n}return n(t,e),t.prototype._addTspan=function(e,t,o){void 0===t&&(t=0),void 0===o&&(o="spanAfter"),this.lineIndexes=this.lineIndexes.map((function(e){return e>=t?e+1:e})),this.tspans.splice(t,0,document.createElementNS("http://www.w3.org/2000/svg","tspan"));var s=this.tspans[t];"spanAfter"===o?this.tspans[t+1]?this.tspans[t+1].insertAdjacentElement("beforebegin",s):this.node.insertAdjacentElement("beforeend",s):this.tspans[t-1]?this.tspans[t-1].insertAdjacentElement("afterend",s):this.node.insertAdjacentElement("afterbegin",s),s.textContent=e,s.style.setProperty("whiteSpace","pre")},t.prototype._setTspanPositioning=function(e,t){"lineBreak"===t?(e.setAttribute("x",this.position[0].toString()),e.setAttribute("dy","1.2em")):"inline"===t&&(e.removeAttribute("x"),e.removeAttribute("dy"))},t.prototype.updateTextBaseline=function(e){this.node.setAttribute("x",e[0].toString()),this.node.setAttribute("y",e[1].toString()),this.tspans.forEach((function(t){t.hasAttribute("x")&&t.setAttribute("x",e[0].toString())}))},t.prototype.setStyle=function(e,t){this.node.style[e]=t},t.prototype.setFontSize=function(e){this.node.style.fontSize=e+"px"},t}(i.Node);o.Text=a})),m=o((function(t,o){var s,n=e&&e.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.GroupNode=void 0;var r=function(e){function t(t,o){var s=e.call(this,t,"group","group")||this,n=document.createElementNS("http://www.w3.org/2000/svg","g");return o.forEach((function(e){return n.appendChild(e.node)})),s.innerNodes=o,s.node=n,s.section=t,s}return n(t,e),t}(i.Node);o.GroupNode=r})),y=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.importData=t.exportData=void 0,t.exportData=function(){var e=[];return this.strokes.forEach((function(t){e.push(t.map((function(e){return e.export()})))})),{exportData:e,strokeIndex:this._strokeIndex,dimensions:this.dimensions,bgType:this.bgType}},t.importData=function(e){var t=this;this.strokes.forEach((function(e){e.forEach((function(e){return e.delete()}))})),this.svg.setAttribute("viewBox","0 0 "+this.dimensions[0]+" "+this.dimensions[1]),e.bgType&&(this.bgType=e.bgType),this.strokes=[],e.exportData.forEach((function(e){t.strokes.push(e.map((function(e){switch(e.type){case"circle":var t=new f.Circle([0,0],0,e.section?e.section:"strokes");return t.import(e.data),t;case"path":var o=new a.Path("",e.section?e.section:"strokes");return o.import(e.data),o;case"text":var s=new S.Text([0,0],"",e.section?e.section:"strokes");return s.import(e.data),s;case"group":var n=new m.GroupNode(e.section?e.section:"strokes",[]);return n.import(e.data),n;case"polygon":var r=new h.Polygon([],e.section?e.section:"strokes");return r.import(e.data),r}})))})),this._strokeIndex=e.strokeIndex;for(var o=0;o<=this._strokeIndex;o++)this._display(this.strokes[o]);return this.emit("import",{import:e}),this}})),k=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeBG=t.changeBackground=void 0,t.changeBackground=function(e){this.bgType=e;var t=u.getBlankGraphPaths(this.dimensions,this.bgColor,this.bgType);return this.normalizeBG(),this.strokes[0].forEach((function(e){return e.delete()})),this.strokes[0]=t,this._display(this.strokes[0]),this},t.normalizeBG=function(){switch(this.bgType.type){case"axes":this.bgType.xOffset=c.clamp(this.bgType.xOffset,0,100),this.bgType.yOffset=c.clamp(this.bgType.yOffset,0,100);break;case"grid":this.bgType.xSpacing=c.clamp(this.bgType.xSpacing,0,100),this.bgType.ySpacing=c.clamp(this.bgType.ySpacing,0,100),0===this.bgType.xSpacing&&(this.bgType.xSpacing=1),0===this.bgType.ySpacing&&(this.bgType.ySpacing=1);break;case"ruled":this.bgType.spacing=c.clamp(this.bgType.spacing,0,100),0===this.bgType.spacing&&(this.bgType.spacing=1)}}})),w=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.attach=t._setViewBox=t._setSVG=void 0,t._setSVG=function(){if(void 0===this.svg)throw"No SVG Element Found";this._setViewBox(this.dimensions,this._offsetX,this._offsetY),this.svg.setAttribute("preserveAspectRatio","none"),this.svgSections={bg:document.createElementNS("http://www.w3.org/2000/svg","g"),strokes:document.createElementNS("http://www.w3.org/2000/svg","g"),overlay:document.createElementNS("http://www.w3.org/2000/svg","g")},this.svg.appendChild(this.svgSections.bg),this.svg.appendChild(this.svgSections.strokes),this.svg.appendChild(this.svgSections.overlay),this._addStroke(u.getBlankGraphPaths(this.dimensions,this.bgColor,this.bgType)),this._display(this.strokes[this._strokeIndex]),this._doRender=!1},t._setViewBox=function(e,t,o){this.svg.setAttribute("viewBox",t+" "+o+" "+e[0]+" "+e[1])},t.attach=function(e,t){return this.dimensions=t,this.originalDimensions=[t[0],t[1]],this.svg=e,this._setSVG(),this}})),x=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.changeOffsets=t.scale=void 0,t.scale=function(e){var t=this.scaleFactor;return this.scaleFactor=e,this.dimensions[0]=this.originalDimensions[0]/e,this.dimensions[1]=this.originalDimensions[1]/e,this.changeOffsets(this._offsetX,this._offsetY),this.emit("change-scale",{oldScaleFactor:t,newScaleFactor:this.scaleFactor}),this},t.changeOffsets=function(e,t){var o={x:this._offsetX,y:this._offsetY};return this._offsetX=c.clamp(e,0,this.originalDimensions[0]-this.dimensions[0]),this._offsetY=c.clamp(t,0,this.originalDimensions[1]-this.dimensions[1]),this._setViewBox(this.dimensions,this._offsetX,this._offsetY),this.emit("change-offsets",{oldOffsets:o,newOffsets:{x:this._offsetX,y:this._offsetY}}),this}})),b=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t._addStroke=t._display=t.draw=t._draw=t._drawFunc=void 0,t._drawFunc=function(e){return this},t._draw=function(){return this.time+=this.timeStep,this._drawFunc(this.time),this},t.draw=function(e){void 0===e&&(e=1);for(var t=0;t<e;t++)this._draw();return this},t._display=function(e){var t=this;e.forEach((function(e){null==e.node.parentElement&&t.svgSections[e.section].appendChild(e.node)}))},t._addStroke=function(e){this.strokes.length>this._strokeIndex+1&&this.strokes.splice(this._strokeIndex+1,this.strokes.length-this._strokeIndex),this.strokes[++this._strokeIndex]=e}})),C=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.toggleRender=t.stopRender=t.startRender=t._render=void 0,t._render=function(){var e=this;this._doRender&&(this.draw(this.drawsPerFrame),this._display(this.strokes[this._strokeIndex]),window.requestAnimationFrame((function(){e._render()})))},t.startRender=function(){return this._doRender||(this._doRender=!0,this._render(),this.emit("start-render",{})),this},t.stopRender=function(){return this._doRender=!1,this.emit("stop-render",{}),this},t.toggleRender=function(){return this._doRender=!this._doRender,this._doRender&&this._render(),this}})),T=o((function(t,o){var r,i=e&&e.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),a=e&&e.__assign||function(){return(a=Object.assign||function(e){for(var t,o=1,s=arguments.length;o<s;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},h=e&&e.__createBinding||(Object.create?function(e,t,o,s){void 0===s&&(s=o),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,s){void 0===s&&(s=o),e[s]=t[o]}),c=e&&e.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||h(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),o.RealRenderer=o.RealRendererTypes=void 0,o.RealRendererTypes=d,c(l,o);var f=function(e){function t(t,o){void 0===o&&(o=n.RealRendererEventList);var s=e.call(this,o)||this;return s._offsetX=0,s._offsetY=0,s.strokes=[],s._strokeIndex=-1,s.undo=p.undo,s.redo=p.redo,s.exportData=y.exportData,s.importData=y.importData,s.changeBackground=k.changeBackground,s.scale=x.scale,s.changeOffsets=x.changeOffsets,s.attach=w.attach,s.draw=b.draw,s.startRender=C.startRender,s.stopRender=C.stopRender,s.toggleRender=C.toggleRender,s.normalizeBG=k.normalizeBG,s._setSVG=w._setSVG,s._setViewBox=w._setViewBox,s._drawFunc=b._drawFunc,s._draw=b._draw,s._display=b._display,s._addStroke=b._addStroke,s._render=C._render,s.settings=a(a({},l.RealRendererDefaults),t),s.bgType=s.settings.bgType,s.normalizeBG(),s.bgColor=s.settings.bgColor,s.drawsPerFrame=s.settings.drawsPerFrame,s.timeStep=s.settings.timeStep,s.time=s.settings.initTime,s.scaleFactor=s.settings.scaleFactor,s}return i(t,e),t.prototype.resetTime=function(){return this.time=0,this},t.prototype.reset=function(){return this.strokes=[u.getBlankGraphPaths(this.dimensions,this.bgColor,this.bgType)],this._strokeIndex=0,this.resetTime(),this._display(this.strokes[this._strokeIndex]),this},t}(s.EventEmitter);o.RealRenderer=f})),P=o((function(t,o){var s=e&&e.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var s=Array(e),n=0;for(t=0;t<o;t++)for(var r=arguments[t],i=0,a=r.length;i<a;i++,n++)s[n]=r[i];return s};Object.defineProperty(o,"__esModule",{value:!0}),o.RealDrawBoardEventList=void 0,o.RealDrawBoardEventList=s(n.RealRendererEventList,["tool-change","tool-setting-change","board-cleared","board-reset"])})),R=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getCircleNode=void 0,t.getCircleNode=function(e,t,o,s){var n=new f.Circle(e,t,s);return n.setFill(r.getRGBColorString(o)),n.setStroke(r.getRGBColorString(o)),n}})),E=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getLinePathCommand=void 0,t.getLinePathCommand=function(e,t){var o;return o="M "+e[0]+","+e[1],o+=" L "+t[0]+","+t[1]}})),O=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getRadiusFromThickness=void 0,t.getRadiusFromThickness=function(e){return e/2-.5}})),I=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t._onKey=t._onScroll=t._toolPreview=t._doStroke=t._endStroke=t._startStroke=t.BrushDefaults=t.name=void 0,t.name="brush",t.BrushDefaults={brushColor:[1,1,1],brushSize:1},t._startStroke=function(e,t){this._doPreview=!1;var o=new a.Path("","strokes");o.setStroke(r.getRGBColorString(this.toolSettings.brushColor)),o.setStrokeWidth(this.toolSettings.brushSize),this._addStroke([o]),this._strokeIdentifierMap.set(t,this._strokeIndex),this.strokes[this._strokeIdentifierMap.get(t)].push(R.getCircleNode(e,O.getRadiusFromThickness(this.toolSettings.brushSize),this.toolSettings.brushColor,"strokes"))},t._endStroke=function(e,t){this.strokes[this._strokeIdentifierMap.get(t)].push(R.getCircleNode(e,O.getRadiusFromThickness(this.toolSettings.brushSize),this.toolSettings.brushColor,"strokes")),this._strokeIdentifierMap.delete(t),this._doPreview=!0},t._doStroke=function(e,t){this.strokes[this._strokeIdentifierMap.get(t)].push(R.getCircleNode(e,O.getRadiusFromThickness(this.toolSettings.brushSize),this.toolSettings.brushColor,"strokes")),this.strokes[this._strokeIdentifierMap.get(t)][0].appendPath(E.getLinePathCommand(this._lastCoords.get(t),e))},t._toolPreview=function(e,t){var o;this._previewStroke.has(t)||this._previewStroke.set(t,[]),0==this._previewStroke.get(t).length?((o=R.getCircleNode(e,O.getRadiusFromThickness(this.toolSettings.brushSize),this.toolSettings.brushColor,"overlay")).setFill(r.getRGBColorString(this.toolSettings.brushColor)),o.setStroke(r.getRGBColorString(this.toolSettings.brushColor)),this._previewStroke.get(t).push(o)):((o=this._previewStroke.get(t)[0]).updateCenter(e),o.updateRadius(O.getRadiusFromThickness(this.toolSettings.brushSize)),o.setFill(r.getRGBColorString(this.toolSettings.brushColor)),o.setStroke(r.getRGBColorString(this.toolSettings.brushColor)))},t._onScroll=function(e,t,o){this.changeToolSetting("brushSize",Math.max(1,this.toolSettings.brushSize-e)),this._previewStroke.get(o)&&0!==this._previewStroke.get(o).length&&(this._previewStroke.get(o)[0].updateRadius(O.getRadiusFromThickness(this.toolSettings.brushSize)),this._display(this._previewStroke.get(o)))},t._onKey=function(e){}})),M=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t._onKey=t._onScroll=t._toolPreview=t._doStroke=t._endStroke=t._startStroke=t.EraserDefaults=t.name=void 0,t.name="eraser",t.EraserDefaults={eraserSize:2},t._startStroke=function(e,t){var o=new a.Path("","strokes");o.setStroke(r.getRGBColorString(this.bgColor)),o.setStrokeWidth(this.toolSettings.eraserSize),this._addStroke([o]),this._strokeIdentifierMap.set(t,this._strokeIndex),this.strokes[this._strokeIdentifierMap.get(t)].push(R.getCircleNode(e,O.getRadiusFromThickness(this.toolSettings.eraserSize),this.bgColor,"strokes"))},t._endStroke=function(e,t){this.strokes[this._strokeIdentifierMap.get(t)].push(R.getCircleNode(e,O.getRadiusFromThickness(this.toolSettings.eraserSize),this.bgColor,"strokes")),this._doPreview=!0},t._doStroke=function(e,t){this.strokes[this._strokeIdentifierMap.get(t)].push(R.getCircleNode(e,O.getRadiusFromThickness(this.toolSettings.eraserSize),this.bgColor,"strokes")),this.strokes[this._strokeIdentifierMap.get(t)][0].appendPath(E.getLinePathCommand(this._lastCoords.get(t),e))},t._toolPreview=function(e,t){var o;0==this._previewStroke.get(t).length?((o=R.getCircleNode(e,O.getRadiusFromThickness(this.toolSettings.eraserSize),this.bgColor,"overlay")).setFill(r.getRGBColorString(this.bgColor)),o.setStroke(r.getRGBColorString(this.bgColor)),o.setDashed(r.getRGBColorString(this.bgColor.map((function(e){return 1-e})))),this._previewStroke.get(t).push(o)):((o=this._previewStroke.get(t)[0]).updateCenter(e),o.updateRadius(O.getRadiusFromThickness(this.toolSettings.eraserSize)))},t._onScroll=function(e,t,o){this.changeToolSetting("eraserSize",Math.max(1,this.toolSettings.eraserSize-e)),this._previewStroke.get(o)&&0!==this._previewStroke.get(o).length&&(this._previewStroke.get(o)[0].updateRadius(O.getRadiusFromThickness(this.toolSettings.eraserSize)),this._display(this._previewStroke.get(o)))},t._onKey=function(e){}})),L=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t._onKey=t._onScroll=t._toolPreview=t._doStroke=t._endStroke=t._startStroke=t.LineDefaults=t.name=void 0,t.name="line",t.LineDefaults={lineThickness:1,lineColor:[1,1,1]};var o=new Map;t._startStroke=function(e,t){this._doPreview=!1,this._previewStroke.has(t)&&this._previewStroke.get(t).forEach((function(e){e.delete()}));var s=new a.Path("","strokes");s.setStroke(r.getRGBColorString(this.toolSettings.lineColor)),s.setStrokeWidth(this.toolSettings.lineThickness);var n=R.getCircleNode(e,O.getRadiusFromThickness(this.toolSettings.lineThickness),this.toolSettings.lineColor,"strokes"),i=R.getCircleNode(e,O.getRadiusFromThickness(this.toolSettings.lineThickness),this.toolSettings.lineColor,"strokes");this._addStroke([new m.GroupNode("strokes",[s,n,i])]),this._strokeIdentifierMap.set(t,this._strokeIndex),o.set(t,e)},t._endStroke=function(e,t){var s=this.strokes[this._strokeIdentifierMap.get(t)][0];s.innerNodes[0].updatePath(E.getLinePathCommand(o.get(t),e)),s.innerNodes[2].updateCenter(e),o.delete(t),this._doPreview=!0},t._doStroke=function(e,t){var s=this.strokes[this._strokeIndex][0];s.innerNodes[0].updatePath(E.getLinePathCommand(o.get(t),e)),s.innerNodes[2].updateCenter(e)},t._toolPreview=function(e,t){var o;0==this._previewStroke.get(t).length?((o=R.getCircleNode(e,O.getRadiusFromThickness(this.toolSettings.lineThickness),this.toolSettings.lineColor,"overlay")).setFill(r.getRGBColorString(this.toolSettings.lineColor)),o.setStroke(r.getRGBColorString(this.toolSettings.lineColor)),this._previewStroke.get(t).push(o)):((o=this._previewStroke.get(t)[0]).updateCenter(e),o.updateRadius(O.getRadiusFromThickness(this.toolSettings.lineThickness)),o.setFill(r.getRGBColorString(this.toolSettings.lineColor)),o.setStroke(r.getRGBColorString(this.toolSettings.lineColor)))},t._onScroll=function(e,t,o){this.changeToolSetting("lineThickness",Math.max(1,this.toolSettings.lineThickness-e)),this._previewStroke.get(o)&&0!==this._previewStroke.get(o).length&&(this._previewStroke.get(o)[0].updateRadius(O.getRadiusFromThickness(this.toolSettings.lineThickness)),this._display(this._previewStroke.get(o)))},t._onKey=function(e){}})),j=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t._mapKeyToAction=void 0,t._mapKeyToAction=function(e,t){switch(e.key.toLowerCase()){case"backspace":t.deleteLastCharacter();break;case"arrowleft":t.moveCursorLeft();break;case"arrowright":t.moveCursorRight();break;case"arrowdown":t.moveCursorDown();break;case"arrowup":t.moveCursorUp();break;case"enter":e.shiftKey&&t.newLine();break;case"shift":case"control":break;default:t.appendText(e.key)}}})),B=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t._toolPreview=t._onScroll=t._onKey=t._doStroke=t._endStroke=t._startStroke=t.TextDefaults=t.name=void 0,t.name="text",t.TextDefaults={fontSize:10,fontColor:[1,1,1],textToolMode:"new"};var o,s=new Map;t._startStroke=function(e,t){if("new"===this.toolSettings.textToolMode){this._previewStroke.has(t)&&this._previewStroke.get(t).forEach((function(e){e.delete()})),s.set(t,e);var o=new h.Polygon([e,e,e,e],"overlay");o.setDashed("rgb(0.5, 0.5, 0.5)"),o.setFill("transparent"),this._previewStroke.set(t,[o])}},t._endStroke=function(e,t){if("new"===this.toolSettings.textToolMode){var n=s.get(t),i=n[0],a=n[1],h=[(i+e[0])/2,(a+e[1])/2],u=new S.Text(h,"Enter Text","strokes");u.setFill(r.getRGBColorString(this.toolSettings.fontColor)),u.setFontSize(this.toolSettings.fontSize),this._addStroke([u]),this._strokeIdentifierMap.set(t,this._strokeIndex),this.on("tool-setting-change","text-tool-handler",(function(e){var t=e.settingName,s=e.newValue;"fontColor"===t&&o.setFill(r.getRGBColorString(s)),"fontSize"===t&&o.setFontSize(s)})),o&&o.destroyCursor(),o=u,this.changeToolSetting("textToolMode","edit"),this._previewStroke.has(t)&&(this._previewStroke.get(t).forEach((function(e){return e.delete()})),this._previewStroke.delete(t))}},t._doStroke=function(e,t){if("new"===this.toolSettings.textToolMode){var o=this._previewStroke.get(t)[0],n=s.get(t),r=n[0],i=n[1],a=e[0],h=e[1];o.updatePoints([[r,i],[a,i],[a,h],[r,h]])}},t._onKey=function(e){"edit"===this.toolSettings.textToolMode&&o&&(e.preventDefault(),j._mapKeyToAction(e,o))},t._onScroll=function(e,t,o){},t._toolPreview=function(e,t){}})),D=o((function(t,o){var s=e&&e.__assign||function(){return(s=Object.assign||function(e){for(var t,o=1,s=arguments.length;o<s;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(o,"__esModule",{value:!0}),o.ToolDefaults=o.tools=void 0,o.tools={brush:I,eraser:M,line:L,text:B},o.ToolDefaults=s(s(s(s({},I.BrushDefaults),L.LineDefaults),M.EraserDefaults),B.TextDefaults)})),A=o((function(t,o){var s=e&&e.__assign||function(){return(s=Object.assign||function(e){for(var t,o=1,s=arguments.length;o<s;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(o,"__esModule",{value:!0}),o.RealDrawBoardDefaults=void 0,o.RealDrawBoardDefaults=s(s({},l.RealRendererDefaults),{toolSettings:D.ToolDefaults,allowUndo:!1,maxUndos:10,tool:"brush"})})),F=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})})),N=o((function(t,o){var s=e&&e.__assign||function(){return(s=Object.assign||function(e){for(var t,o=1,s=arguments.length;o<s;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(o,"__esModule",{value:!0}),o._resetBoard=o.clear=o.clearPreview=o.changeToolSetting=o.changeTool=void 0,o.changeTool=function(e){var t=this.tool;return this.tool=e,this._startStroke=D.tools[this.tool]._startStroke,this._doStroke=D.tools[this.tool]._doStroke,this._endStroke=D.tools[this.tool]._endStroke,this._toolPreview=D.tools[this.tool]._toolPreview,this._onScroll=D.tools[this.tool]._onScroll,this._onKey=D.tools[this.tool]._onKey,this._previewStroke.forEach((function(e){e.forEach((function(e){e.delete()}))})),this._previewStroke.clear(),this.emit("tool-change",{newTool:e,oldTool:t}),this},o.changeToolSetting=function(e,t){var o=this.toolSettings[e];return this.toolSettings[e]=t,this.emit("tool-setting-change",{settingName:e,newValue:t,oldValue:o}),this},o.clearPreview=function(){return this._previewStroke.forEach((function(e){e.forEach((function(e){e.delete()}))})),this._previewStroke.clear(),this},o.clear=function(){return this._strokeIndex>0&&(this._strokeIndex=0,this._lastCoords.clear(),this.strokes.forEach((function(e){e.forEach((function(e){return e.delete()}))})),this.strokes=[u.getBlankGraphPaths(this.dimensions,this.bgColor,this.bgType)],this._display(this.strokes[this._strokeIndex]),this.emit("board-cleared",{})),this},o._resetBoard=function(){return this.bgColor=this.settings.bgColor,this.tool=this.settings.tool,this.toolSettings=s(s({},D.ToolDefaults),this.settings.toolSettings),this._lastCoords.clear(),this.stopRender(),this.emit("board-reset",{}),this}})),G=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t._removeDOMEvents=t._addDOMEvents=void 0,t._addDOMEvents=function(){this.svg.addEventListener("mousedown",this._mouseDownEventListener),this.svg.addEventListener("mouseup",this._mouseUpEventListener),this.svg.addEventListener("mouseleave",this._mouseLeaveEventListener),this.svg.addEventListener("mousemove",this._previewMouseMoveEventListener),this.svg.addEventListener("wheel",this._wheelEventListener),document.addEventListener("keydown",this._keyPressEventListener),this.svg.addEventListener("touchstart",this._touchStartEventListener),this.svg.addEventListener("touchmove",this._touchMoveEventListener),this.svg.addEventListener("touchend",this._touchEndEventListener),this.svg.addEventListener("touchmove",this._previewTouchMoveEventListener)},t._removeDOMEvents=function(){this.svg.removeEventListener("mousedown",this._mouseDownEventListener),this.svg.removeEventListener("mouseup",this._mouseUpEventListener),this.svg.removeEventListener("mouseexit",this._mouseLeaveEventListener),this.svg.removeEventListener("mousemove",this._previewMouseMoveEventListener),this.svg.removeEventListener("wheel",this._wheelEventListener),document.removeEventListener("keydown",this._keyPressEventListener),this.svg.removeEventListener("touchstart",this._touchStartEventListener),this.svg.removeEventListener("touchmove",this._touchMoveEventListener),this.svg.removeEventListener("touchend",this._touchEndEventListener),this.svg.removeEventListener("touchmove",this._previewTouchMoveEventListener)}})),z=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t._getTouchCoords=t._getMouseCoords=void 0,t._getMouseCoords=function(e){var t=this.dimensions[0]/this.svg.clientWidth,o=this.dimensions[1]/this.svg.clientHeight;return[e.offsetX*t+this._offsetX,e.offsetY*o+this._offsetY]},t._getTouchCoords=function(e){var t=this.dimensions[0]/this.svg.clientWidth,o=this.dimensions[1]/this.svg.clientHeight;return[(e.clientX-this.svg.getBoundingClientRect().left+this._offsetY)*t,(e.clientY-this.svg.getBoundingClientRect().top+this._offsetY)*o]}})),K=o((function(t,o){var s,n=e&&e.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=e&&e.__assign||function(){return(r=Object.assign||function(e){for(var t,o=1,s=arguments.length;o<s;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},i=e&&e.__createBinding||(Object.create?function(e,t,o,s){void 0===s&&(s=o),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,s){void 0===s&&(s=o),e[s]=t[o]}),a=e&&e.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||i(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),o.RealDrawBoard=o.RealDrawBoardTypes=o.RealRendererTypes=void 0,o.RealRendererTypes=d,o.RealDrawBoardTypes=F,a(A,o);var h=function(e){function t(t){var o=e.call(this,t,P.RealDrawBoardEventList)||this;return o.tool=A.RealDrawBoardDefaults.tool,o._lastCoords=new Map,o._doPreview=!0,o._previewStroke=new Map,o._strokeIdentifierMap=new Map,o._resetBoard=N._resetBoard,o._addDOMEvents=G._addDOMEvents,o._removeDOMEvents=G._removeDOMEvents,o._startStroke=D.tools[A.RealDrawBoardDefaults.tool]._startStroke,o._endStroke=D.tools[A.RealDrawBoardDefaults.tool]._endStroke,o._doStroke=D.tools[A.RealDrawBoardDefaults.tool]._doStroke,o._toolPreview=D.tools[A.RealDrawBoardDefaults.tool]._toolPreview,o._onScroll=D.tools[A.RealDrawBoardDefaults.tool]._onScroll,o._onKey=D.tools[A.RealDrawBoardDefaults.tool]._onKey,o._getMouseCoords=z._getMouseCoords,o._getTouchCoords=z._getTouchCoords,o.changeToolSetting=N.changeToolSetting,o.changeTool=N.changeTool,o.clearPreview=N.clearPreview,o.clear=N.clear,o._mouseDownEventListener=function(e){if(0===e.button)if(e.ctrlKey)o.svg.addEventListener("mousemove",o._panEventListener);else{o.svg.addEventListener("mousemove",o._mouseMoveEventListener);var t=o._getMouseCoords(e);o._startStroke(t,"mouse"),o._lastCoords.set("mouse",t)}},o._mouseUpEventListener=function(e){if(0===e.button){var t=o._getMouseCoords(e);o.svg.removeEventListener("mousemove",o._mouseMoveEventListener),o.svg.removeEventListener("mousemove",o._panEventListener),o._lastCoords.has("mouse")&&(o._endStroke(t,"mouse"),o._lastCoords.delete("mouse")),o._display(o.strokes[o._strokeIndex])}},o._mouseLeaveEventListener=function(e){o.svg.removeEventListener("mousemove",o._mouseMoveEventListener),o._lastCoords.has("mouse")&&(o._endStroke(o._getMouseCoords(e),"mouse"),o._lastCoords.delete("mouse"),o._display(o.strokes[o._strokeIndex])),o.clearPreview()},o._mouseMoveEventListener=function(e){var t=o._getMouseCoords(e);o._doStroke(t,"mouse"),o._lastCoords.set("mouse",t)},o._previewMouseMoveEventListener=function(e){var t=o._getMouseCoords(e);o._doPreview&&(o._previewStroke.has("mouse")||o._previewStroke.set("mouse",[]),o._toolPreview(t,"mouse"),o._display(o._previewStroke.get("mouse"))),o._display(o.strokes[o._strokeIndex])},o._wheelEventListener=function(e){e.preventDefault(),e.ctrlKey?o.scale(Math.max(o.scaleFactor-.001*e.deltaY,1)):o._onScroll(.05*e.deltaY,o._getMouseCoords(e),"mouse")},o._panEventListener=function(e){e.ctrlKey&&o.changeOffsets(o._offsetX-e.movementX,o._offsetY-e.movementY)},o._keyPressEventListener=function(e){o._onKey(e)},o._touchStartEventListener=function(e){e.preventDefault();for(var t=0;t<e.touches.length;t++){var s=o._getTouchCoords(e.touches.item(t)),n=e.touches.item(t).identifier.toString();o._startStroke(s,n),o._lastCoords.set(n,s)}},o._touchEndEventListener=function(e){for(var t=0;t<e.changedTouches.length;t++){var s=o._getTouchCoords(e.changedTouches.item(t)),n=e.changedTouches.item(t).identifier.toString();o._endStroke(s,n),o._lastCoords.delete(n)}o.clearPreview()},o._touchMoveEventListener=function(e){for(var t=0;t<e.touches.length;t++){var s=o._getTouchCoords(e.touches.item(t));o._doStroke(s,e.touches.item(t).identifier.toString()),o._lastCoords.set(e.touches.item(t).identifier.toString(),s)}},o._previewTouchMoveEventListener=function(e){for(var t=0;t<e.touches.length;t++){var s=o._getTouchCoords(e.touches.item(t)),n=e.touches.item(t).identifier.toString();o._doPreview&&(o._previewStroke.has(n)||o._previewStroke.set(n,[]),o._toolPreview(s,n),o._display(o._previewStroke.get(n))),o._display(o.strokes[o._strokeIndex])}},o.startRender=function(){return this._addDOMEvents(),this},o.stopRender=function(){return this._removeDOMEvents(),this},o.settings=r(r(r({},A.RealDrawBoardDefaults),t),{toolSettings:r(r({},A.RealDrawBoardDefaults.toolSettings),"toolSettings"in t?t.toolSettings:{})}),o.toolSettings=r(r({},D.ToolDefaults),o.settings.toolSettings),o.changeTool(o.settings.tool),o}return n(t,e),t.prototype.reset=function(){return this._resetBoard(),e.prototype.reset.call(this),this},t}(T.RealRenderer);o.RealDrawBoard=h})),V=o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.renderPreview=void 0,t.renderPreview=function(e,t){var o=e.exportData,s=e.dimensions;t.setAttribute("viewBox","0 0 "+s[0]+" "+s[1]),o.forEach((function(e){e.forEach((function(e){t.innerHTML+=e.data}))}))}}));return t(o((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.renderPreview=t.RealRenderer=t.RealDrawBoard=void 0,Object.defineProperty(t,"RealDrawBoard",{enumerable:!0,get:function(){return K.RealDrawBoard}}),Object.defineProperty(t,"RealRenderer",{enumerable:!0,get:function(){return T.RealRenderer}}),Object.defineProperty(t,"renderPreview",{enumerable:!0,get:function(){return V.renderPreview}})})))}));
